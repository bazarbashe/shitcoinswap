!!!
%html
  %head
    %meta{content: "text/html; charset=UTF-8", "http-equiv" => "Content-Type"}
    %title= t 'app_name'
    %meta{charset: "utf-8"}
    %meta{content: "width=device-width, initial-scale=1, shrink-to-fit=no", name: "viewport"}
    %link{href: "/apple-touch-icon.png", rel: "apple-touch-icon", sizes: "76x76"}
    %link{href: "/favicon-32x32.png", rel: "icon", sizes: "32x32", type: "image/png"}
    %link{href: "/favicon-16x16.png", rel: "icon", sizes: "16x16", type: "image/png"}
    %link{href: "/site.webmanifest", rel: "manifest"}
    %link{color: "#bb0000", href: "/safari-pinned-tab.svg", rel: "mask-icon"}
    %meta{content: "#bb0000", name: "msapplication-TileColor"}
    %meta{content: "#ffffff", name: "theme-color"}
    - if @no_cache
      %meta(name="turbolinks-cache-control" content="no-cache")
    = csrf_meta_tags
    = csp_meta_tag
    = javascript_tag do
      __INITIAL_STATE__= {
      platforms: #{raw Platform.all.to_json(only: [:id], methods: [:name])},
      authenticity_token: #{raw form_authenticity_token.to_json},
      - if current_user
        balances: #{raw current_user.cached_balances_json}
      }
    = javascript_include_tag "https://cdn.jsdelivr.net/npm/vue@2.5.17/dist/vue.js"
    = javascript_include_tag 'application', integrity: true
    = stylesheet_link_tag    'application', media: 'all'
    = content_for :head
    
  %body{class: params[:controller]}
    - if current_user.try(:admin?)
      %nav.navbar.navbar-dark.bg-dark.fixed-bottom.navbar-expand-lg
        .nav-item Admin Menu 
        .nav-item= link_to 'Platforms', admin_platforms_path
        .nav-item= link_to 'Withdrawals', admin_withdrawals_path
        .nav-item= link_to 'Assets', admin_assets_path
    %nav.navbar.sticky-top.navbar-light.bg-white.border-bottom.navbar-expand-lg
      = link_to image_tag('logo_name.png', height: 19), root_path, class: 'navbar-brand mr-auto'
      - if current_user
        .nav-item= "Logged in as #{current_user.email}"
        .nav-item= link_to 'My Balances', '/cached_balances', class: 'nav-link'
        .nav-item= link_to 'Log Out', logout_path, method: :delete, class: 'nav-link'
      - else
        / not logged in
        .nav-item= link_to (t '.log_in'), login_path
      .dropdown.nav-item
        %a#dropdownMenuButton.nav-link.dropdown-toggle{"href" => "#", "aria-haspopup" => "true", "data-toggle" => "dropdown"}
          = I18n.locale
        .dropdown-menu.dropdown-menu-right{"aria-labelledby" => "dropdownMenuButton"}
          = link_to (t '.english'), {locale: 'en'}, class: 'dropdown-item'
          = link_to (t '.japanese'), {locale: 'ja'}, class: 'dropdown-item'
    .container
      - if notice
        .alert.alert-success= notice
      - if alert
        .alert.alert-warning= alert
    = yield
    .container
      %footer.pt-4.my-md-5.pt-md-5.border-top
        .row
          .col-md-5.text-muted.text-left
            = t '.coypright_2018'
          .col-md-2.text-center
            = image_tag 'logo.png', class: 'mb-2', width: 24, height: 24
          .col-md-5.text-muted.text-right
            = link_to (t '.contact'), page_url(:contact), class: 'text-muted'
            = t '.deposits', :status_first => (Status.first.last_deposits_ran_at > 2.minutes.ago ? 'OK' : 'Stopped')
            = t '.withdrawals_1', :status_first => (Status.first.last_withdrawals_ran_at > 2.minutes.ago ? 'OK' : 'Stopped')

